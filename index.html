<!DOCTYPE html>

<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>محاكاة معركة بين هيليوس والمهيمنين</title>
<!-- Chart.js for data visualization -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-19HNCP3BE3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-19HNCP3BE3');
</script>
<style>
    /* General Styles */
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
        background-color: #033c73; /* Deeper blue background */
        background: linear-gradient(135deg, #033c73, #0099cc); /* Blue gradient similar to game interface */
        background-size: cover;
        background-attachment: fixed;
        color: #333;
        line-height: 1.6;
        padding: 20px;
        /* Protection against content copying */
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-touch-callout: none;
        -webkit-tap-highlight-color: transparent;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        background-color: rgba(255, 255, 255, 0.9);
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        padding: 20px;
    }

    h1, h2, h3, h4 {
        color: #2c3e50;
        margin-bottom: 15px;
    }

    h1 {
        text-align: center;
        font-size: 32px;
        border-bottom: 2px solid #3498db;
        padding-bottom: 10px;
        margin-bottom: 20px;
    }

    p {
        margin-bottom: 15px;
    }

    /* Header Section */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .logo-container {
        display: flex;
        align-items: center;
        gap: 20px;
    }

    .faction-logo {
        width: 60px;
        height: 60px;
        object-fit: contain;
    }

    .header-image {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto 20px;
        border-radius: 5px;
    }

    /* Tabs */
    .tabs {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        margin-bottom: 20px;
        gap: 5px;
    }

    .tab-button {
        padding: 12px 20px;
        border: none;
        background-color: #95a5a6;
        color: white;
        cursor: pointer;
        font-weight: bold;
        border-radius: 5px 5px 0 0;
        transition: background-color 0.3s;
    }

    .tab-button:hover {
        background-color: #7f8c8d;
    }

    .tab-button.active {
        background-color: #3498db;
    }

    .tab-content {
        display: none;
        padding: 20px;
        background-color: white;
        border-radius: 0 5px 5px 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .tab-content.active {
        display: block;
    }

    /* Form Elements */
    .form-group {
        margin-bottom: 15px;
    }

    label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #2c3e50;
    }

    .input-row {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 15px;
    }

    .input-group {
        flex: 1;
        min-width: 200px;
    }

    select, input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
    }

    button {
        background-color: #3498db;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        transition: background-color 0.3s;
    }

    button:hover {
        background-color: #2980b9;
    }
    
    button:disabled {
        background-color: #95a5a6;
        cursor: not-allowed;
    }

    /* Tables */
    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    th, td {
        padding: 12px 15px;
        text-align: right;
        border-bottom: 1px solid #ddd;
    }

    th {
        background-color: #3498db;
        color: white;
        font-weight: bold;
    }

    tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    tr:hover {
        background-color: #f1f1f1;
    }

    .table-header {
        font-weight: bold;
        background-color: #3498db;
        color: white;
    }

    .positive-diff {
        color: #27ae60;
        font-weight: bold;
    }

    .negative-diff {
        color: #e74c3c;
        font-weight: bold;
    }

    .important-stat {
        font-weight: bold;
        background-color: #f0f8ff;
    }

    /* Charts */
    .chart-container {
        margin: 20px 0;
        height: 300px;
        width: 100%;
    }

    .comparison-result {
        margin-top: 20px;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 5px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .chart-row {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin: 20px 0;
    }

    .chart-column {
        flex: 1;
        min-width: 300px;
    }

    /* Battle Simulation */
    .army-config {
        padding: 15px;
        margin-bottom: 20px;
        background-color: #f9f9f9;
        border-radius: 5px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .helios-config {
        border-right: 5px solid #3498db; /* Blue for Helios */
    }

    .dominant-config {
        border-right: 5px solid #e74c3c; /* Red for Dominant */
    }

    .troop-count {
        font-weight: bold;
        color: #3498db;
    }

    /* Percentage sliders */
    .percentage-slider-container {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }
    
    .percentage-slider-container label {
        min-width: 120px;
        margin-right: 10px;
        margin-bottom: 0;
    }
    
    .percentage-slider-container input[type="range"] {
        flex: 1;
        height: 10px;
        border-radius: 5px;
        background: #ddd;
        outline: none;
    }
    
    .percentage-slider-container input[type="number"] {
        width: 60px;
        margin-right: 10px;
        text-align: center;
    }
    
    .percentage-total {
        margin-top: 10px;
        font-weight: bold;
        text-align: center;
        padding: 5px;
        border-radius: 5px;
    }
    
    .percentage-total.valid {
        background-color: #e8f5e9;
        color: #388e3c;
    }
    
    .percentage-total.invalid {
        background-color: #ffebee;
        color: #d32f2f;
    }

    /* Battle Results */
    .battle-results {
        display: none;
        margin-top: 30px;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 5px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .battle-winner {
        font-size: 24px;
        text-align: center;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 5px;
        font-weight: bold;
    }

    .battle-winner.helios {
        background-color: #e3f2fd;
        color: #1565c0;
    }

    .battle-winner.dominant {
        background-color: #ffebee;
        color: #c62828;
    }

    .battle-winner.draw {
        background-color: #eaeded;
        color: #7f8c8d;
    }

    .battle-details {
        padding: 15px;
        background-color: white;
        border-radius: 5px;
        margin-bottom: 20px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .battle-stats {
        font-size: 16px;
        padding: 15px;
        background-color: #f0f8ff;
        border-radius: 5px;
    }
    
    /* Combat mechanics */
    .combat-mechanics {
        margin: 20px 0;
        padding: 15px;
        background-color: #eaf2f8;
        border-radius: 5px;
        border-right: 3px solid #3498db;
    }
    
    /* Skills */
    .skills-container {
        margin-top: 20px;
        padding: 15px;
        background-color: #fff8e1;
        border-radius: 5px;
        border-right: 3px solid #ffc107;
    }
    
    .skill-badge {
        display: inline-block;
        margin: 5px;
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 12px;
        color: white;
        background: linear-gradient(135deg, #3498db, #2980b9);
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .skill-title {
        font-weight: bold;
        margin-bottom: 3px;
    }
    
    /* Countdown */
    .countdown {
        font-size: 48px;
        font-weight: bold;
        text-align: center;
        margin: 20px 0;
        color: #3498db;
    }
    
    /* Result GIF */
    .result-gif {
        display: block;
        max-width: 100%;
        margin: 20px auto;
        border-radius: 5px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    /* Analysis */
    .analysis {
        padding: 15px;
        background-color: #e8f5e9;
        border-radius: 5px;
        margin-top: 20px;
        border-right: 3px solid #4caf50;
    }
    
    /* Footer */
    .footer {
        margin-top: 50px;
        text-align: center;
        padding: 20px;
        background-color: #2196f3;
        color: white;
        border-radius: 5px;
    }
    
    .footer a {
        color: #e3f2fd;
        margin: 0 10px;
        text-decoration: none;
    }
    
    .footer a:hover {
        text-decoration: underline;
        color: #ffffff;
    }
    
    /* Social Media Icons */
    .social-icons {
        position: fixed;
        top: 50%;
        left: 20px;
        transform: translateY(-50%);
        display: flex;
        flex-direction: column;
        gap: 15px;
        z-index: 1000;
    }
    
    .social-icon {
        display: block;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        text-decoration: none;
        font-size: 24px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        transition: all 0.3s ease;
        opacity: 0.8;
    }
    
    .social-icon:hover {
        transform: scale(1.1);
        opacity: 1;
        box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }
    
    .youtube-icon {
        background-color: #ff0000;
    }
    
    .discord-icon {
        background-color: #7289da;
    }
    
    /* Modal Overlay */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        backdrop-filter: blur(5px);
    }
    
    .modal-content {
        background-color: white;
        padding: 40px;
        border-radius: 15px;
        text-align: center;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        animation: modalAppear 0.3s ease-out;
    }
    
    @keyframes modalAppear {
        from {
            opacity: 0;
            transform: scale(0.8);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }
    
    .modal-title {
        font-size: 24px;
        color: #333;
        margin-bottom: 30px;
        font-weight: bold;
        line-height: 1.4;
    }
    
    .modal-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .modal-btn {
        padding: 15px 30px;
        border: none;
        border-radius: 10px;
        font-size: 18px;
        font-weight: bold;
        color: white;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s ease;
        min-width: 200px;
        justify-content: center;
    }
    
    .modal-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .youtube-btn {
        background-color: #FF0000;
    }
    
    .youtube-btn:hover {
        background-color: #CC0000;
    }
    
    .discord-btn {
        background-color: #7289DA;
    }
    
    .discord-btn:hover {
        background-color: #5B6FB8;
    }
    
    .modal-icon {
        font-size: 20px;
    }
    
    /* Hidden class for modal */
    .hidden {
        display: none !important;
    }
    
    .credits {
        font-style: italic;
        text-align: center;
        font-size: 12px;
        margin: 10px 0;
        color: #555;
    }
    
    /* Promotional message */
    .promotional-message {
        background: #e3f2fd;
        padding: 10px;
        margin: 15px 0;
        border-radius: 5px;
        border-right: 4px solid #2196f3;
        font-weight: bold;
        color: #0d47a1;
        text-align: center;
    }
    
    /* Mobile responsiveness */
    @media screen and (max-width: 768px) {
        .input-row {
            flex-direction: column;
        }
        
        .input-group {
            width: 100%;
        }
        
        .chart-row {
            flex-direction: column;
        }
        
        .percentage-slider-container {
            flex-wrap: wrap;
        }
        
        .percentage-slider-container label {
            width: 100%;
            margin-bottom: 5px;
        }
        
        .percentage-slider-container input[type="range"] {
            width: 70%;
        }
        
        .percentage-slider-container input[type="number"] {
            width: 20%;
        }
    }
</style>
</head>
<body>
<!-- Modal Overlay -->
<div id="subscriptionModal" class="modal-overlay">
    <div class="modal-content">
        <h2 class="modal-title">يرجى الاشتراك في القناة لتجربة محاكاة القتال</h2>
        <div class="modal-buttons">
            <a href="https://www.youtube.com/@whiteoutsurvivel" target="_blank" class="modal-btn youtube-btn" onclick="trackClick('YouTube_Modal'); hideModal();">
                <i class="fab fa-youtube modal-icon"></i>
                اشترك في YouTube
            </a>
            <a href="https://discord.gg/yEKvcA5eBq" target="_blank" class="modal-btn discord-btn" onclick="trackClick('Discord_Modal'); hideModal();">
                <i class="fab fa-discord modal-icon"></i>
                انضم إلى Discord
            </a>
        </div>
    </div>
</div>

<!-- Social Media Icons -->
<div class="social-icons">
    <a href="https://www.youtube.com/@whiteoutsurvivel" target="_blank" class="social-icon youtube-icon" title="قناة اليوتيوب" onclick="trackClick('YouTube_SideIcon')">
        ▶
    </a>
    <a href="https://discord.gg/yEKvcA5eBq" target="_blank" class="social-icon discord-icon" title="ديسكورد" onclick="trackClick('Discord_SideIcon')">
        💬
    </a>
</div>

<div class="container">
    <header>
        <img class="header-image" id="coverImage" alt="صورة الغلاف" src="https://i.imgur.com/pKGIpPk.gif" />
        <h1>محاكاة معركة بين هيليوس والمهيمنين</h1>
    </header>
    
    <div class="tabs">
        <button class="tab-button active" data-tab="infantry-comparison">مقارنة المشاة</button>
        <button class="tab-button" data-tab="archers-comparison">مقارنة الرماة</button>
        <button class="tab-button" data-tab="spearmen-comparison">مقارنة الرمح</button>
        <button class="tab-button" data-tab="battle-simulation">محاكاة القتال</button>
        <button class="tab-button" data-tab="challenge">التحدي</button>
    </div>
    
    <!-- Infantry Comparison Tab -->
    <div id="infantry-comparison" class="tab-content active">
        <div class="logo-container">
            <div class="faction-logo">🛡️ هيليوس</div>
            <h2>مقارنة المشاة</h2>
            <div class="faction-logo">🛡️ المهيمنين</div>
        </div>
        
        <div class="promotional-message">
            ندعوك للاشتراك في قناتنا لدعم المشروع! Whiteout Survival Comparison المعايير لا تشمل عتاد الحاكم.
        </div>
        
        <div class="input-row">
            <div class="input-group">
                <label for="heliosInfantryLevel">مستوى مشاة هيليوس</label>
                <select id="heliosInfantryLevel">
                    <option value="1">مستوى 1</option>
                    <option value="2">مستوى 2</option>
                    <option value="3">مستوى 3</option>
                    <option value="4">مستوى 4</option>
                    <option value="5">مستوى 5</option>
                    <option value="6">مستوى 6</option>
                    <option value="7">مستوى 7</option>
                    <option value="8">مستوى 8</option>
                    <option value="9">مستوى 9</option>
                    <option value="10">مستوى 10</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="dominatorsInfantryLevel">مستوى مشاة المهيمنين</label>
                <select id="dominatorsInfantryLevel">
                    <option value="1">مستوى 1</option>
                    <option value="2">مستوى 2</option>
                    <option value="3">مستوى 3</option>
                    <option value="4">مستوى 4</option>
                    <option value="5">مستوى 5</option>
                    <option value="6">مستوى 6</option>
                    <option value="7">مستوى 7</option>
                    <option value="8">مستوى 8</option>
                    <option value="9">مستوى 9</option>
                    <option value="10">مستوى 10</option>
                </select>
            </div>
        </div>
        
        <button onclick="compareUnits('infantry')" class="compare-button">قارن</button>
        
        <div class="chart-row">
            <div class="chart-column">
                <h3>مشاة هيليوس</h3>
                <table id="heliosInfantryTable">
                    <thead>
                        <tr>
                            <th>المستوى</th>
                            <th>هجوم</th>
                            <th>دفاع</th>
                            <th>صحة</th>
                            <th>فتك</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="chart-column">
                <h3>مشاة المهيمنين</h3>
                <table id="dominatorsInfantryTable">
                    <thead>
                        <tr>
                            <th>المستوى</th>
                            <th>هجوم</th>
                            <th>دفاع</th>
                            <th>صحة</th>
                            <th>فتك</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        
        <div id="infantryComparisonResult" class="comparison-result">
            <p>اختر المستويات وانقر على "قارن" لرؤية النتائج</p>
        </div>
        
        <div class="chart-container">
            <canvas id="infantryChart"></canvas>
        </div>
    </div>
    
    <!-- Archers Comparison Tab -->
    <div id="archers-comparison" class="tab-content">
        <div class="logo-container">
            <div class="faction-logo">🏹 هيليوس</div>
            <h2>مقارنة الرماة</h2>
            <div class="faction-logo">🏹 المهيمنين</div>
        </div>
        
        <div class="promotional-message">
            ندعوك للاشتراك في قناتنا لدعم المشروع! Whiteout Survival Comparison المعايير لا تشمل عتاد الحاكم.
        </div>
        
        <div class="input-row">
            <div class="input-group">
                <label for="heliosArchersLevel">مستوى رماة هيليوس</label>
                <select id="heliosArchersLevel">
                    <option value="1">مستوى 1</option>
                    <option value="2">مستوى 2</option>
                    <option value="3">مستوى 3</option>
                    <option value="4">مستوى 4</option>
                    <option value="5">مستوى 5</option>
                    <option value="6">مستوى 6</option>
                    <option value="7">مستوى 7</option>
                    <option value="8">مستوى 8</option>
                    <option value="9">مستوى 9</option>
                    <option value="10">مستوى 10</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="dominatorsArchersLevel">مستوى رماة المهيمنين</label>
                <select id="dominatorsArchersLevel">
                    <option value="1">مستوى 1</option>
                    <option value="2">مستوى 2</option>
                    <option value="3">مستوى 3</option>
                    <option value="4">مستوى 4</option>
                    <option value="5">مستوى 5</option>
                    <option value="6">مستوى 6</option>
                    <option value="7">مستوى 7</option>
                    <option value="8">مستوى 8</option>
                    <option value="9">مستوى 9</option>
                    <option value="10">مستوى 10</option>
                </select>
            </div>
        </div>
        
        <button onclick="compareUnits('archers')" class="compare-button">قارن</button>
        
        <div class="chart-row">
            <div class="chart-column">
                <h3>رماة هيليوس</h3>
                <table id="heliosArchersTable">
                    <thead>
                        <tr>
                            <th>المستوى</th>
                            <th>هجوم</th>
                            <th>دفاع</th>
                            <th>صحة</th>
                            <th>فتك</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="chart-column">
                <h3>رماة المهيمنين</h3>
                <table id="dominatorsArchersTable">
                    <thead>
                        <tr>
                            <th>المستوى</th>
                            <th>هجوم</th>
                            <th>دفاع</th>
                            <th>صحة</th>
                            <th>فتك</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        
        <div id="archersComparisonResult" class="comparison-result">
            <p>اختر المستويات وانقر على "قارن" لرؤية النتائج</p>
        </div>
        
        <div class="chart-container">
            <canvas id="archersChart"></canvas>
        </div>
    </div>
    
    <!-- Spearmen Comparison Tab -->
    <div id="spearmen-comparison" class="tab-content">
        <div class="logo-container">
            <div class="faction-logo">⚔️ هيليوس</div>
            <h2>مقارنة الرمح</h2>
            <div class="faction-logo">⚔️ المهيمنين</div>
        </div>
        
        <div class="promotional-message">
            ندعوك للاشتراك في قناتنا لدعم المشروع! Whiteout Survival Comparison المعايير لا تشمل عتاد الحاكم.
        </div>
        
        <div class="input-row">
            <div class="input-group">
                <label for="heliosSpearmenLevel">مستوى رمح هيليوس</label>
                <select id="heliosSpearmenLevel">
                    <option value="1">مستوى 1</option>
                    <option value="2">مستوى 2</option>
                    <option value="3">مستوى 3</option>
                    <option value="4">مستوى 4</option>
                    <option value="5">مستوى 5</option>
                    <option value="6">مستوى 6</option>
                    <option value="7">مستوى 7</option>
                    <option value="8">مستوى 8</option>
                    <option value="9">مستوى 9</option>
                    <option value="10">مستوى 10</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="dominatorsSpearmenLevel">مستوى رمح المهيمنين</label>
                <select id="dominatorsSpearmenLevel">
                    <option value="1">مستوى 1</option>
                    <option value="2">مستوى 2</option>
                    <option value="3">مستوى 3</option>
                    <option value="4">مستوى 4</option>
                    <option value="5">مستوى 5</option>
                    <option value="6">مستوى 6</option>
                    <option value="7">مستوى 7</option>
                    <option value="8">مستوى 8</option>
                    <option value="9">مستوى 9</option>
                    <option value="10">مستوى 10</option>
                </select>
            </div>
        </div>
        
        <button onclick="compareUnits('spearmen')" class="compare-button">قارن</button>
        
        <div class="chart-row">
            <div class="chart-column">
                <h3>رمح هيليوس</h3>
                <table id="heliosSpearmenTable">
                    <thead>
                        <tr>
                            <th>المستوى</th>
                            <th>هجوم</th>
                            <th>دفاع</th>
                            <th>صحة</th>
                            <th>فتك</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="chart-column">
                <h3>رمح المهيمنين</h3>
                <table id="dominatorsSpearmenTable">
                    <thead>
                        <tr>
                            <th>المستوى</th>
                            <th>هجوم</th>
                            <th>دفاع</th>
                            <th>صحة</th>
                            <th>فتك</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        
        <div id="spearmenComparisonResult" class="comparison-result">
            <p>اختر المستويات وانقر على "قارن" لرؤية النتائج</p>
        </div>
        
        <div class="chart-container">
            <canvas id="spearmenChart"></canvas>
        </div>
    </div>
    
    <!-- Battle Simulation Tab -->
    <div id="battle-simulation" class="tab-content">
        <h2>محاكاة القتال</h2>
        
        <div class="promotional-message">
            ندعوك للاشتراك في قناتنا لدعم المشروع! Whiteout Survival Comparison المعايير لا تشمل عتاد الحاكم.
        </div>
        

        
        <div class="input-row">
            <div class="army-config helios-config">
                <h3>جيش هيليوس</h3>
                <div class="input-group">
                    <label for="heliosCount">عدد القوات (الحد الأقصى: 100,000)</label>
                    <input type="number" id="heliosCount" min="1" max="100000" value="10000">
                </div>
                
                <div class="input-group">
                    <label for="heliosBattleInfantryLevel">مستوى المشاة</label>
                    <select id="heliosBattleInfantryLevel">
                        <option value="1">مستوى 1</option>
                        <option value="2">مستوى 2</option>
                        <option value="3">مستوى 3</option>
                        <option value="4">مستوى 4</option>
                        <option value="5">مستوى 5</option>
                        <option value="6">مستوى 6</option>
                        <option value="7">مستوى 7</option>
                        <option value="8">مستوى 8</option>
                        <option value="9">مستوى 9</option>
                        <option value="10">مستوى 10</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="heliosBattleArchersLevel">مستوى الرماة</label>
                    <select id="heliosBattleArchersLevel">
                        <option value="1">مستوى 1</option>
                        <option value="2">مستوى 2</option>
                        <option value="3">مستوى 3</option>
                        <option value="4">مستوى 4</option>
                        <option value="5">مستوى 5</option>
                        <option value="6">مستوى 6</option>
                        <option value="7">مستوى 7</option>
                        <option value="8">مستوى 8</option>
                        <option value="9">مستوى 9</option>
                        <option value="10">مستوى 10</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="heliosBattleSpearmenLevel">مستوى الرمح</label>
                    <select id="heliosBattleSpearmenLevel">
                        <option value="1">مستوى 1</option>
                        <option value="2">مستوى 2</option>
                        <option value="3">مستوى 3</option>
                        <option value="4">مستوى 4</option>
                        <option value="5">مستوى 5</option>
                        <option value="6">مستوى 6</option>
                        <option value="7">مستوى 7</option>
                        <option value="8">مستوى 8</option>
                        <option value="9">مستوى 9</option>
                        <option value="10">مستوى 10</option>
                    </select>
                </div>
                
                <h4>نسب القوات (المجموع: 100%)</h4>
                <div class="percentage-slider-container">
                    <label for="heliosInfantrySlider">نسبة المشاة</label>
                    <input type="range" id="heliosInfantrySlider" min="0" max="100" value="40">
                    <input type="number" id="heliosInfantryPercent" min="0" max="100" value="40">
                </div>
                
                <div class="percentage-slider-container">
                    <label for="heliosArchersSlider">نسبة الرماة</label>
                    <input type="range" id="heliosArchersSlider" min="0" max="100" value="30">
                    <input type="number" id="heliosArchersPercent" min="0" max="100" value="30">
                </div>
                
                <div class="percentage-slider-container">
                    <label for="heliosSpearmenSlider">نسبة الرمح</label>
                    <input type="range" id="heliosSpearmenSlider" min="0" max="100" value="30">
                    <input type="number" id="heliosSpearmenPercent" min="0" max="100" value="30">
                </div>
                
                <div id="heliosPercentageTotal" class="percentage-total valid">
                    المجموع: 100%
                </div>
                
                <div class="skills-container">
                    <h4>المهارات القتالية:</h4>
                    <div id="heliosInfantrySkills"></div>
                    <div id="heliosArchersSkills"></div>
                    <div id="heliosSpearmenSkills"></div>
                </div>
            </div>
            
            <div class="army-config dominant-config">
                <h3>جيش المهيمنين</h3>
                <div class="input-group">
                    <label for="dominatorsCount">عدد القوات (الحد الأقصى: 100,000)</label>
                    <input type="number" id="dominatorsCount" min="1" max="100000" value="10000">
                </div>
                
                <div class="input-group">
                    <label for="dominatorsBattleInfantryLevel">مستوى المشاة</label>
                    <select id="dominatorsBattleInfantryLevel">
                        <option value="1">مستوى 1</option>
                        <option value="2">مستوى 2</option>
                        <option value="3">مستوى 3</option>
                        <option value="4">مستوى 4</option>
                        <option value="5">مستوى 5</option>
                        <option value="6">مستوى 6</option>
                        <option value="7">مستوى 7</option>
                        <option value="8">مستوى 8</option>
                        <option value="9">مستوى 9</option>
                        <option value="10">مستوى 10</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="dominatorsBattleArchersLevel">مستوى الرماة</label>
                    <select id="dominatorsBattleArchersLevel">
                        <option value="1">مستوى 1</option>
                        <option value="2">مستوى 2</option>
                        <option value="3">مستوى 3</option>
                        <option value="4">مستوى 4</option>
                        <option value="5">مستوى 5</option>
                        <option value="6">مستوى 6</option>
                        <option value="7">مستوى 7</option>
                        <option value="8">مستوى 8</option>
                        <option value="9">مستوى 9</option>
                        <option value="10">مستوى 10</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="dominatorsBattleSpearmenLevel">مستوى الرمح</label>
                    <select id="dominatorsBattleSpearmenLevel">
                        <option value="1">مستوى 1</option>
                        <option value="2">مستوى 2</option>
                        <option value="3">مستوى 3</option>
                        <option value="4">مستوى 4</option>
                        <option value="5">مستوى 5</option>
                        <option value="6">مستوى 6</option>
                        <option value="7">مستوى 7</option>
                        <option value="8">مستوى 8</option>
                        <option value="9">مستوى 9</option>
                        <option value="10">مستوى 10</option>
                    </select>
                </div>
                
                <h4>نسب القوات (المجموع: 100%)</h4>
                <div class="percentage-slider-container">
                    <label for="dominatorsInfantrySlider">نسبة المشاة</label>
                    <input type="range" id="dominatorsInfantrySlider" min="0" max="100" value="40">
                    <input type="number" id="dominatorsInfantryPercent" min="0" max="100" value="40">
                </div>
                
                <div class="percentage-slider-container">
                    <label for="dominatorsArchersSlider">نسبة الرماة</label>
                    <input type="range" id="dominatorsArchersSlider" min="0" max="100" value="30">
                    <input type="number" id="dominatorsArchersPercent" min="0" max="100" value="30">
                </div>
                
                <div class="percentage-slider-container">
                    <label for="dominatorsSpearmenSlider">نسبة الرمح</label>
                    <input type="range" id="dominatorsSpearmenSlider" min="0" max="100" value="30">
                    <input type="number" id="dominatorsSpearmenPercent" min="0" max="100" value="30">
                </div>
                
                <div id="dominatorsPercentageTotal" class="percentage-total valid">
                    المجموع: 100%
                </div>
                
                <div class="skills-container">
                    <h4>المهارات القتالية:</h4>
                    <div id="dominatorsInfantrySkills"></div>
                    <div id="dominatorsArchersSkills"></div>
                    <div id="dominatorsSpearmenSkills"></div>
                </div>
            </div>
        </div>
        
        <div class="input-group">
            <label for="attacker">المهاجم:</label>
            <select id="attacker">
                <option value="helios">هيليوس</option>
                <option value="dominators">المهيمنين</option>
            </select>
        </div>
        
        <button id="simulateBattleButton" class="compare-button" onclick="simulateBattle()">محاكاة القتال</button>
        
        <div id="countdown" class="countdown" style="display: none;">3</div>
        
        <div id="battleResult" class="battle-results" style="display: none;">
            <h3>نتيجة المعركة</h3>
            <img id="resultGif" class="result-gif" style="display: none;">
            <div id="battleWinner" class="battle-winner"></div>
            <div id="battleDetails" class="battle-details"></div>
            <div id="battleAnalysis" class="analysis"></div>
            <div class="chart-container">
                <canvas id="battleChart"></canvas>
            </div>
        </div>
    </div>
    
    <!-- Challenge Tab -->
    <div id="challenge" class="tab-content">
        <h2>التحدي</h2>
        
        <div class="promotional-message">
            ندعوك للاشتراك في قناتنا لدعم المشروع! Whiteout Survival Comparison المعايير لا تشمل عتاد الحاكم.
        </div>
        
        <div class="challenge-opponent">
            <h3>الخصم</h3>
            <p>هيليوس مستوى 4</p>
            <p>تكوين: رماة 45%، رمح 15%، مشاة 40%</p>
            <p>العدد: 100,000 جندي</p>
        </div>
        
        <div class="input-row">
            <div class="input-group">
                <label for="challengeFaction">اختر فصيلك</label>
                <select id="challengeFaction">
                    <option value="helios">هيليوس</option>
                    <option value="dominators">المهيمنين</option>
                </select>
            </div>
        </div>
        
        <h4>نسب القوات (المجموع: 100%)</h4>
        <div class="percentage-slider-container">
            <label for="challengeInfantrySlider">نسبة المشاة</label>
            <input type="range" id="challengeInfantrySlider" min="0" max="100" value="40">
            <input type="number" id="challengeInfantryPercent" min="0" max="100" value="40">
        </div>
        
        <div class="percentage-slider-container">
            <label for="challengeArchersSlider">نسبة الرماة</label>
            <input type="range" id="challengeArchersSlider" min="0" max="100" value="30">
            <input type="number" id="challengeArchersPercent" min="0" max="100" value="30">
        </div>
        
        <div class="percentage-slider-container">
            <label for="challengeSpearmenSlider">نسبة الرمح</label>
            <input type="range" id="challengeSpearmenSlider" min="0" max="100" value="30">
            <input type="number" id="challengeSpearmenPercent" min="0" max="100" value="30">
        </div>
        
        <div id="challengePercentageTotal" class="percentage-total valid">
            المجموع: 100%
        </div>
        
        <button id="startChallengeButton" class="compare-button" onclick="startChallenge()">بدء التحدي</button>
        
        <div id="challengeResult" class="battle-results" style="display: none;">
            <h3>نتيجة التحدي</h3>
            <div id="challengeWinner" class="battle-winner"></div>
            <div id="challengeDetails" class="battle-details"></div>
            <div class="chart-container">
                <canvas id="challengeChart"></canvas>
            </div>
        </div>
    </div>
    
    <div class="credits">
        حقوق وتصميم: <a href="https://t.me/fulldesigne" target="_blank">https://t.me/fulldesigne</a> كل ما تحتاجه في عالم التصميم والجرافيك
    </div>
    
    <div class="footer">
        <p>اشترك لدعم المشروع:</p>
        <a href="https://www.youtube.com/@whiteoutsurvivel" target="_blank">قناة يوتيوب</a> |
        <a href="https://discord.gg/9p2DZsz9" target="_blank">انضم إلينا على ديسكورد</a>
    </div>
</div>

<script>
    // Unit statistics data
    const unitStats = {
        heliosInfantry: {
            attack: [13, 14, 15, 15, 16, 17, 17, 18, 18, 19],
            defense: [16, 17, 18, 19, 22, 23, 24, 25, 27, 28],
            health: [18, 19, 20, 21, 22, 23, 24, 25, 26, 27],
            lethality: [12, 13, 14, 15, 15, 16, 16, 17, 17, 18]
        },
        heliosArchers: {
            attack: [17, 19, 20, 21, 23, 24, 25, 26, 28, 30],
            defense: [13, 14, 15, 16, 16, 17, 18, 19, 19, 21],
            health: [13, 14, 15, 15, 16, 16, 17, 18, 18, 20],
            lethality: [18, 19, 20, 21, 22, 23, 24, 25, 26, 27]
        },
        heliosSpearmen: {
            attack: [16, 18, 19, 20, 21, 22, 23, 24, 25, 26],
            defense: [14, 15, 16, 16, 17, 17, 18, 19, 19, 21],
            health: [13, 14, 15, 15, 16, 16, 17, 17, 18, 20],
            lethality: [17, 18, 19, 20, 22, 23, 24, 25, 27, 28]
        },
        dominatorsInfantry: {
            attack: [11, 12, 13, 13, 14, 14, 15, 15, 16, 18],
            defense: [14, 16, 17, 18, 20, 21, 22, 23, 25, 26],
            health: [16, 17, 18, 19, 20, 21, 22, 23, 24, 25],
            lethality: [10, 11, 12, 13, 13, 13, 14, 15, 15, 16]
        },
        dominatorsArchers: {
            attack: [15, 17, 18, 19, 21, 22, 23, 24, 26, 27],
            defense: [11, 12, 13, 14, 14, 15, 15, 16, 17, 19],
            health: [11, 12, 13, 13, 14, 14, 15, 15, 16, 17],
            lethality: [16, 17, 18, 19, 20, 21, 22, 23, 24, 25]
        },
        dominatorsSpearmen: {
            attack: [14, 16, 17, 18, 20, 21, 22, 23, 25, 26],
            defense: [12, 13, 14, 14, 15, 15, 16, 17, 17, 19],
            health: [11, 12, 13, 13, 14, 14, 15, 15, 16, 17],
            lethality: [15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
        }
    };
    
    // Battle skills data
    const battleSkills = {
        infantry: {
            common: [
                { name: "سيد الشجعان", description: "+10% ضرر ضد رماة الرمح" },
                { name: "دعامات فولاذية", description: "+10% دفاع ضد رماة الرمح" }
            ],
            levelBased: {
                3: { name: "كريستال ناري", description: "تقليل 25% من الضرر" },
                5: { name: "كريستال أقوى", description: "تقليل 35% من الضرر" },
                8: { name: "جسم الضوء", description: "+4% دفاع، -10% ضرر" },
                10: { name: "جسم الضوء II", description: "+6% دفاع، -15% ضرر" }
            }
        },
        spearmen: {
            common: [
                { name: "الاندفاع", description: "+10% ضد رماة الرمح" },
                { name: "المتربص", description: "فرصة 20% لتجاوز الصف الأمامي" }
            ]
        },
        archers: {
            common: [
                { name: "ضربة بعيدة المدى", description: "+10% ضرر ضد المشاة" }
            ]
        }
    };
    
    // Chart objects to manage chart instances
    const chartObjects = {};
    
    // DOM ready
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize tabs
        initTabs();
        
        // Populate tables with unit data
        populateUnitTables();
        
        // Setup percentage sliders
        setupPercentageSliders('helios');
        setupPercentageSliders('dominators');
        setupPercentageSliders('challenge');
        
        // Update battle skills display
        updateBattleSkills();
    });
    
    // Initialize tabs
    function initTabs() {
        const tabButtons = document.querySelectorAll('.tab-button');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Remove active class from all buttons and content
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.style.display = 'none');
                
                // Add active class to current button and show content
                this.classList.add('active');
                document.getElementById(tabId).style.display = 'block';
            });
        });
    }
    
    // Populate unit tables with data
    function populateUnitTables() {
        populateUnitTable('heliosInfantryTable', unitStats.heliosInfantry);
        populateUnitTable('dominatorsInfantryTable', unitStats.dominatorsInfantry);
        populateUnitTable('heliosArchersTable', unitStats.heliosArchers);
        populateUnitTable('dominatorsArchersTable', unitStats.dominatorsArchers);
        populateUnitTable('heliosSpearmenTable', unitStats.heliosSpearmen);
        populateUnitTable('dominatorsSpearmenTable', unitStats.dominatorsSpearmen);
    }
    
    // Helper function to populate a unit table
    function populateUnitTable(tableId, stats) {
        const table = document.getElementById(tableId);
        if (table) {
            const tbody = table.querySelector('tbody');
            if (tbody) {
                tbody.innerHTML = '';
                
                for (let level = 0; level < 10; level++) {
                    const tr = document.createElement('tr');
                    
                    // Level column
                    const tdLevel = document.createElement('td');
                    tdLevel.textContent = level + 1;
                    tr.appendChild(tdLevel);
                    
                    // Attack column
                    const tdAttack = document.createElement('td');
                    tdAttack.textContent = stats.attack[level];
                    tr.appendChild(tdAttack);
                    
                    // Defense column
                    const tdDefense = document.createElement('td');
                    tdDefense.textContent = stats.defense[level];
                    tr.appendChild(tdDefense);
                    
                    // Health column
                    const tdHealth = document.createElement('td');
                    tdHealth.textContent = stats.health[level];
                    tr.appendChild(tdHealth);
                    
                    // Lethality column
                    const tdLethality = document.createElement('td');
                    tdLethality.textContent = stats.lethality[level];
                    tr.appendChild(tdLethality);
                    
                    tbody.appendChild(tr);
                }
            }
        }
    }
    
    // Compare units
    function compareUnits(unitType) {
        const heliosLevel = parseInt(document.getElementById(`helios${capitalizeFirstLetter(unitType)}Level`).value);
        const dominatorsLevel = parseInt(document.getElementById(`dominators${capitalizeFirstLetter(unitType)}Level`).value);
        
        // Get unit stats
        const heliosStats = {
            attack: unitStats[`helios${capitalizeFirstLetter(unitType)}`].attack[heliosLevel - 1],
            defense: unitStats[`helios${capitalizeFirstLetter(unitType)}`].defense[heliosLevel - 1],
            health: unitStats[`helios${capitalizeFirstLetter(unitType)}`].health[heliosLevel - 1],
            lethality: unitStats[`helios${capitalizeFirstLetter(unitType)}`].lethality[heliosLevel - 1],
            level: heliosLevel
        };
        
        const dominatorsStats = {
            attack: unitStats[`dominators${capitalizeFirstLetter(unitType)}`].attack[dominatorsLevel - 1],
            defense: unitStats[`dominators${capitalizeFirstLetter(unitType)}`].defense[dominatorsLevel - 1],
            health: unitStats[`dominators${capitalizeFirstLetter(unitType)}`].health[dominatorsLevel - 1],
            lethality: unitStats[`dominators${capitalizeFirstLetter(unitType)}`].lethality[dominatorsLevel - 1],
            level: dominatorsLevel
        };
        
        // Calculate power using the formula: power = (attack × 0.35) + (defense × 0.25) + (health × 0.2) + (lethality × 0.2)
        const heliosPower = calculatePower(heliosStats);
        const dominatorsPower = calculatePower(dominatorsStats);
        
        // Update comparison results
        updateComparisonResults(unitType, heliosStats, dominatorsStats, heliosPower, dominatorsPower);
        
        // Draw comparison chart
        drawComparisonChart(unitType, heliosStats, dominatorsStats);
    }
    
    // Calculate unit power
    function calculatePower(stats) {
        return (stats.attack * 0.35) + (stats.defense * 0.25) + (stats.health * 0.2) + (stats.lethality * 0.2);
    }
    
    // Update comparison results
    function updateComparisonResults(unitType, heliosStats, dominatorsStats, heliosPower, dominatorsPower) {
        const resultElement = document.getElementById(`${unitType}ComparisonResult`);
        if (!resultElement) return;
        
        const powerDiff = Math.abs(heliosPower - dominatorsPower);
        const powerRatio = (powerDiff / Math.min(heliosPower, dominatorsPower) * 100).toFixed(1);
        
        // Create result HTML
        let resultHTML = '';
        
        if (heliosPower > dominatorsPower) {
            resultHTML += `<h3>قوة هيليوس أعلى بنسبة ${powerRatio}%</h3>`;
            resultHTML += `<p>قوة هيليوس: <strong>${heliosPower.toFixed(2)}</strong></p>`;
            resultHTML += `<p>قوة المهيمنين: <strong>${dominatorsPower.toFixed(2)}</strong></p>`;
            
            // Add stat comparison
            resultHTML += '<div class="stat-comparison">';
            resultHTML += `<p>هجوم: ${heliosStats.attack} مقابل ${dominatorsStats.attack} (${heliosStats.attack > dominatorsStats.attack ? '+' : ''}${heliosStats.attack - dominatorsStats.attack})</p>`;
            resultHTML += `<p>دفاع: ${heliosStats.defense} مقابل ${dominatorsStats.defense} (${heliosStats.defense > dominatorsStats.defense ? '+' : ''}${heliosStats.defense - dominatorsStats.defense})</p>`;
            resultHTML += `<p>صحة: ${heliosStats.health} مقابل ${dominatorsStats.health} (${heliosStats.health > dominatorsStats.health ? '+' : ''}${heliosStats.health - dominatorsStats.health})</p>`;
            resultHTML += `<p>فتك: ${heliosStats.lethality} مقابل ${dominatorsStats.lethality} (${heliosStats.lethality > dominatorsStats.lethality ? '+' : ''}${heliosStats.lethality - dominatorsStats.lethality})</p>`;
            resultHTML += '</div>';
        } else if (dominatorsPower > heliosPower) {
            resultHTML += `<h3>قوة المهيمنين أعلى بنسبة ${powerRatio}%</h3>`;
            resultHTML += `<p>قوة المهيمنين: <strong>${dominatorsPower.toFixed(2)}</strong></p>`;
            resultHTML += `<p>قوة هيليوس: <strong>${heliosPower.toFixed(2)}</strong></p>`;
            
            // Add stat comparison
            resultHTML += '<div class="stat-comparison">';
            resultHTML += `<p>هجوم: ${dominatorsStats.attack} مقابل ${heliosStats.attack} (${dominatorsStats.attack > heliosStats.attack ? '+' : ''}${dominatorsStats.attack - heliosStats.attack})</p>`;
            resultHTML += `<p>دفاع: ${dominatorsStats.defense} مقابل ${heliosStats.defense} (${dominatorsStats.defense > heliosStats.defense ? '+' : ''}${dominatorsStats.defense - heliosStats.defense})</p>`;
            resultHTML += `<p>صحة: ${dominatorsStats.health} مقابل ${heliosStats.health} (${dominatorsStats.health > heliosStats.health ? '+' : ''}${dominatorsStats.health - heliosStats.health})</p>`;
            resultHTML += `<p>فتك: ${dominatorsStats.lethality} مقابل ${heliosStats.lethality} (${dominatorsStats.lethality > heliosStats.lethality ? '+' : ''}${dominatorsStats.lethality - heliosStats.lethality})</p>`;
            resultHTML += '</div>';
        } else {
            resultHTML += '<h3>القوتان متساويتان</h3>';
            resultHTML += `<p>قوة هيليوس والمهيمنين: <strong>${heliosPower.toFixed(2)}</strong></p>`;
        }
        
        resultElement.innerHTML = resultHTML;
        resultElement.style.display = 'block';
    }
    
    // Draw comparison chart
    function drawComparisonChart(unitType, heliosStats, dominatorsStats) {
        const ctx = document.getElementById(`${unitType}Chart`);
        if (!ctx) return;
        
        // Destroy existing chart if it exists
        if (chartObjects[unitType]) {
            try {
                chartObjects[unitType].destroy();
            } catch (e) {
                console.log(`Error destroying ${unitType} chart:`, e);
            }
        }
        
        // Create new chart
        chartObjects[unitType] = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['هجوم', 'دفاع', 'صحة', 'فتك'],
                datasets: [
                    {
                        label: `هيليوس (مستوى ${heliosStats.level})`,
                        data: [heliosStats.attack, heliosStats.defense, heliosStats.health, heliosStats.lethality],
                        backgroundColor: 'rgba(244, 67, 54, 0.2)',
                        borderColor: 'rgba(244, 67, 54, 1)',
                        pointBackgroundColor: 'rgba(244, 67, 54, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(244, 67, 54, 1)',
                        borderWidth: 1
                    },
                    {
                        label: `المهيمنين (مستوى ${dominatorsStats.level})`,
                        data: [dominatorsStats.attack, dominatorsStats.defense, dominatorsStats.health, dominatorsStats.lethality],
                        backgroundColor: 'rgba(255, 193, 7, 0.2)',
                        borderColor: 'rgba(255, 193, 7, 1)',
                        pointBackgroundColor: 'rgba(255, 193, 7, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(255, 193, 7, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                scales: {
                    r: {
                        beginAtZero: true,
                        ticks: {
                            display: false
                        }
                    }
                }
            }
        });
    }
    
    // Setup percentage sliders
    function setupPercentageSliders(faction) {
        const infantrySlider = document.getElementById(`${faction}InfantrySlider`);
        const archersSlider = document.getElementById(`${faction}ArchersSlider`);
        const spearmenSlider = document.getElementById(`${faction}SpearmenSlider`);
        
        const infantryInput = document.getElementById(`${faction}InfantryPercent`);
        const archersInput = document.getElementById(`${faction}ArchersPercent`);
        const spearmenInput = document.getElementById(`${faction}SpearmenPercent`);
        
        if (infantrySlider && archersSlider && spearmenSlider) {
            // Add event listeners to sliders
            infantrySlider.addEventListener('input', () => balancePercentages(faction, 'infantry'));
            archersSlider.addEventListener('input', () => balancePercentages(faction, 'archers'));
            spearmenSlider.addEventListener('input', () => balancePercentages(faction, 'spearmen'));
            
            // Add event listeners to numeric inputs
            infantryInput.addEventListener('input', () => updateFromNumberInput(faction, 'infantry'));
            archersInput.addEventListener('input', () => updateFromNumberInput(faction, 'archers'));
            spearmenInput.addEventListener('input', () => updateFromNumberInput(faction, 'spearmen'));
            
            // Initialize percentages
            updatePercentageDisplay(faction);
        }
    }
    
    // Balance percentages to ensure they sum to 100%
    function balancePercentages(faction, changedUnit) {
        const infantry = document.getElementById(`${faction}InfantrySlider`);
        const archers = document.getElementById(`${faction}ArchersSlider`);
        const spearmen = document.getElementById(`${faction}SpearmenSlider`);
        
        const infantryVal = parseInt(infantry.value);
        const archersVal = parseInt(archers.value);
        const spearmenVal = parseInt(spearmen.value);
        
        const total = infantryVal + archersVal + spearmenVal;
        
        // If total is not 100%, adjust other values
        if (total !== 100) {
            const diff = 100 - total;
            
            if (changedUnit === 'infantry') {
                // Distribute the difference between archers and spearmen
                const archersRatio = archersVal / (archersVal + spearmenVal || 1);
                const newArchersVal = Math.max(0, Math.min(100, archersVal + Math.round(diff * archersRatio)));
                const newSpearmenVal = 100 - infantryVal - newArchersVal;
                
                archers.value = newArchersVal;
                spearmen.value = newSpearmenVal;
            } else if (changedUnit === 'archers') {
                // Distribute the difference between infantry and spearmen
                const infantryRatio = infantryVal / (infantryVal + spearmenVal || 1);
                const newInfantryVal = Math.max(0, Math.min(100, infantryVal + Math.round(diff * infantryRatio)));
                const newSpearmenVal = 100 - newInfantryVal - archersVal;
                
                infantry.value = newInfantryVal;
                spearmen.value = newSpearmenVal;
            } else if (changedUnit === 'spearmen') {
                // Distribute the difference between infantry and archers
                const infantryRatio = infantryVal / (infantryVal + archersVal || 1);
                const newInfantryVal = Math.max(0, Math.min(100, infantryVal + Math.round(diff * infantryRatio)));
                const newArchersVal = 100 - newInfantryVal - spearmenVal;
                
                infantry.value = newInfantryVal;
                archers.value = newArchersVal;
            }
        }
        
        // Update numeric input fields
        document.getElementById(`${faction}InfantryPercent`).value = infantry.value;
        document.getElementById(`${faction}ArchersPercent`).value = archers.value;
        document.getElementById(`${faction}SpearmenPercent`).value = spearmen.value;
        
        // Update the percentage display
        updatePercentageDisplay(faction);
    }
    
    // Update from number input
    function updateFromNumberInput(faction, changedUnit) {
        const input = document.getElementById(`${faction}${capitalizeFirstLetter(changedUnit)}Percent`);
        const slider = document.getElementById(`${faction}${capitalizeFirstLetter(changedUnit)}Slider`);
        
        // Ensure value is within 0-100 range
        let value = parseInt(input.value) || 0;
        value = Math.max(0, Math.min(100, value));
        
        // Update slider value
        slider.value = value;
        input.value = value;
        
        // Balance other percentages
        balancePercentages(faction, changedUnit);
    }
    
    // Update percentage display
    function updatePercentageDisplay(faction) {
        const infantry = parseInt(document.getElementById(`${faction}InfantrySlider`).value);
        const archers = parseInt(document.getElementById(`${faction}ArchersSlider`).value);
        const spearmen = parseInt(document.getElementById(`${faction}SpearmenSlider`).value);
        
        const total = infantry + archers + spearmen;
        
        const totalElement = document.getElementById(`${faction}PercentageTotal`);
        if (totalElement) {
            totalElement.textContent = `المجموع: ${total}%`;
            
            if (total === 100) {
                totalElement.classList.add('valid');
                totalElement.classList.remove('invalid');
                
                // Enable battle simulation button if both factions have valid percentages
                if (faction === 'helios' || faction === 'dominators') {
                    const heliosTotalElement = document.getElementById('heliosPercentageTotal');
                    const dominatorsTotalElement = document.getElementById('dominatorsPercentageTotal');
                    const simulateButton = document.getElementById('simulateBattleButton');
                    
                    if (simulateButton && heliosTotalElement && dominatorsTotalElement &&
                        heliosTotalElement.classList.contains('valid') &&
                        dominatorsTotalElement.classList.contains('valid')) {
                        simulateButton.disabled = false;
                    }
                } else if (faction === 'challenge') {
                    document.getElementById('startChallengeButton').disabled = false;
                }
            } else {
                totalElement.classList.add('invalid');
                totalElement.classList.remove('valid');
                
                if (faction === 'helios' || faction === 'dominators') {
                    document.getElementById('simulateBattleButton').disabled = true;
                } else if (faction === 'challenge') {
                    document.getElementById('startChallengeButton').disabled = true;
                }
            }
        }
    }
    
    // Update battle skills display
    function updateBattleSkills() {
        // Update Helios skills
        updateFactionSkills('helios');
        
        // Update Dominators skills
        updateFactionSkills('dominators');
        
        // Add event listeners to level selectors
        document.getElementById('heliosBattleInfantryLevel').addEventListener('change', () => updateFactionSkills('helios'));
        document.getElementById('heliosBattleArchersLevel').addEventListener('change', () => updateFactionSkills('helios'));
        document.getElementById('heliosBattleSpearmenLevel').addEventListener('change', () => updateFactionSkills('helios'));
        
        document.getElementById('dominatorsBattleInfantryLevel').addEventListener('change', () => updateFactionSkills('dominators'));
        document.getElementById('dominatorsBattleArchersLevel').addEventListener('change', () => updateFactionSkills('dominators'));
        document.getElementById('dominatorsBattleSpearmenLevel').addEventListener('change', () => updateFactionSkills('dominators'));
    }
    
    // Update faction skills
    function updateFactionSkills(faction) {
        const infantryLevel = parseInt(document.getElementById(`${faction}BattleInfantryLevel`).value);
        const archersLevel = parseInt(document.getElementById(`${faction}BattleArchersLevel`).value);
        const spearmenLevel = parseInt(document.getElementById(`${faction}BattleSpearmenLevel`).value);
        
        // Update infantry skills
        updateUnitSkills(faction, 'infantry', infantryLevel);
        
        // Update archers skills
        updateUnitSkills(faction, 'archers', archersLevel);
        
        // Update spearmen skills
        updateUnitSkills(faction, 'spearmen', spearmenLevel);
    }
    
    // Update unit skills
    function updateUnitSkills(faction, unitType, level) {
        const skillsContainer = document.getElementById(`${faction}${capitalizeFirstLetter(unitType)}Skills`);
        if (!skillsContainer) return;
        
        let skillsHTML = `<h5>${capitalizeFirstLetter(unitType)} (مستوى ${level}):</h5>`;
        
        // Add common skills
        if (battleSkills[unitType] && battleSkills[unitType].common) {
            battleSkills[unitType].common.forEach(skill => {
                skillsHTML += `<span class="skill-badge">${skill.name}: ${skill.description}</span>`;
            });
        }
        
        // Add level-based skills
        if (battleSkills[unitType] && battleSkills[unitType].levelBased) {
            for (let skillLevel in battleSkills[unitType].levelBased) {
                if (level >= parseInt(skillLevel)) {
                    const skill = battleSkills[unitType].levelBased[skillLevel];
                    skillsHTML += `<span class="skill-badge">${skill.name} (مستوى ${skillLevel}): ${skill.description}</span>`;
                }
            }
        }
        
        skillsContainer.innerHTML = skillsHTML;
    }
    
    // Simulate battle
    function simulateBattle() {
        // Show countdown
        const countdownElement = document.getElementById('countdown');
        countdownElement.style.display = 'block';
        
        let count = 3;
        countdownElement.textContent = count;
        
        const countdownInterval = setInterval(() => {
            count--;
            if (count <= 0) {
                clearInterval(countdownInterval);
                countdownElement.style.display = 'none';
                calculateBattleResult();
            } else {
                countdownElement.textContent = count;
            }
        }, 1000);
    }
    
    // Calculate battle result
    function calculateBattleResult() {
        // Get input values
        const heliosCount = parseInt(document.getElementById('heliosCount').value) || 0;
        const dominatorsCount = parseInt(document.getElementById('dominatorsCount').value) || 0;
        
        // Get unit percentages
        const heliosInfantryPercent = parseInt(document.getElementById('heliosInfantryPercent').value) || 0;
        const heliosArchersPercent = parseInt(document.getElementById('heliosArchersPercent').value) || 0;
        const heliosSpearmenPercent = parseInt(document.getElementById('heliosSpearmenPercent').value) || 0;
        
        const dominatorsInfantryPercent = parseInt(document.getElementById('dominatorsInfantryPercent').value) || 0;
        const dominatorsArchersPercent = parseInt(document.getElementById('dominatorsArchersPercent').value) || 0;
        const dominatorsSpearmenPercent = parseInt(document.getElementById('dominatorsSpearmenPercent').value) || 0;
        
        // Get unit levels
        const heliosInfantryLevel = parseInt(document.getElementById('heliosBattleInfantryLevel').value) || 1;
        const heliosArchersLevel = parseInt(document.getElementById('heliosBattleArchersLevel').value) || 1;
        const heliosSpearmenLevel = parseInt(document.getElementById('heliosBattleSpearmenLevel').value) || 1;
        
        const dominatorsInfantryLevel = parseInt(document.getElementById('dominatorsBattleInfantryLevel').value) || 1;
        const dominatorsArchersLevel = parseInt(document.getElementById('dominatorsBattleArchersLevel').value) || 1;
        const dominatorsSpearmenLevel = parseInt(document.getElementById('dominatorsBattleSpearmenLevel').value) || 1;
        
        // Get attacker
        const attacker = document.getElementById('attacker').value;
        
        // Get unit stats
        const heliosInfantryStats = getUnitStats('helios', 'infantry', heliosInfantryLevel);
        const heliosArchersStats = getUnitStats('helios', 'archers', heliosArchersLevel);
        const heliosSpearmenStats = getUnitStats('helios', 'spearmen', heliosSpearmenLevel);
        
        const dominatorsInfantryStats = getUnitStats('dominators', 'infantry', dominatorsInfantryLevel);
        const dominatorsArchersStats = getUnitStats('dominators', 'archers', dominatorsArchersLevel);
        const dominatorsSpearmenStats = getUnitStats('dominators', 'spearmen', dominatorsSpearmenLevel);
        
        // Apply battle skills
        const heliosInfantryModified = applyBattleSkills('helios', 'infantry', heliosInfantryStats, heliosInfantryLevel, dominatorsSpearmenStats);
        const heliosArchersModified = applyBattleSkills('helios', 'archers', heliosArchersStats, heliosArchersLevel, dominatorsInfantryStats);
        const heliosSpearmenModified = applyBattleSkills('helios', 'spearmen', heliosSpearmenStats, heliosSpearmenLevel, dominatorsArchersStats);
        
        const dominatorsInfantryModified = applyBattleSkills('dominators', 'infantry', dominatorsInfantryStats, dominatorsInfantryLevel, heliosSpearmenStats);
        const dominatorsArchersModified = applyBattleSkills('dominators', 'archers', dominatorsArchersStats, dominatorsArchersLevel, heliosInfantryStats);
        const dominatorsSpearmenModified = applyBattleSkills('dominators', 'spearmen', dominatorsSpearmenStats, dominatorsSpearmenLevel, heliosArchersStats);
        
        // Calculate damage using the formula: Damage = (Attack × (1 + Lethality / 100)) - (Defense × 0.5)
        const heliosInfantryDamage = calculateDamage(heliosInfantryModified, dominatorsInfantryModified);
        const heliosArchersDamage = calculateDamage(heliosArchersModified, dominatorsArchersModified);
        const heliosSpearmenDamage = calculateDamage(heliosSpearmenModified, dominatorsSpearmenModified);
        
        const dominatorsInfantryDamage = calculateDamage(dominatorsInfantryModified, heliosInfantryModified);
        const dominatorsArchersDamage = calculateDamage(dominatorsArchersModified, heliosArchersModified);
        const dominatorsSpearmenDamage = calculateDamage(dominatorsSpearmenModified, heliosSpearmenModified);
        
        // Calculate total damage: TotalDamage = Damage × UnitCount × (Percentage / 100)
        const heliosTotalInfantryDamage = heliosInfantryDamage * heliosCount * (heliosInfantryPercent / 100);
        const heliosTotalArchersDamage = heliosArchersDamage * heliosCount * (heliosArchersPercent / 100);
        const heliosTotalSpearmenDamage = heliosSpearmenDamage * heliosCount * (heliosSpearmenPercent / 100);
        
        const dominatorsTotalInfantryDamage = dominatorsInfantryDamage * dominatorsCount * (dominatorsInfantryPercent / 100);
        const dominatorsTotalArchersDamage = dominatorsArchersDamage * dominatorsCount * (dominatorsArchersPercent / 100);
        const dominatorsTotalSpearmenDamage = dominatorsSpearmenDamage * dominatorsCount * (dominatorsSpearmenPercent / 100);
        
        // Calculate total damage for each faction
        const heliosTotalDamage = heliosTotalInfantryDamage + heliosTotalArchersDamage + heliosTotalSpearmenDamage;
        const dominatorsTotalDamage = dominatorsTotalInfantryDamage + dominatorsTotalArchersDamage + dominatorsTotalSpearmenDamage;
        
        // Apply attacker bonus (10% more damage)
        let heliosFinalDamage = heliosTotalDamage;
        let dominatorsFinalDamage = dominatorsTotalDamage;
        
        if (attacker === 'helios') {
            heliosFinalDamage *= 1.1;
        } else {
            dominatorsFinalDamage *= 1.1;
        }
        
        // Determine winner
        const isHeliosWinner = heliosFinalDamage > dominatorsFinalDamage;
        const isDraw = heliosFinalDamage === dominatorsFinalDamage;
        
        // Display results
        displayBattleResults(
            isHeliosWinner, 
            isDraw,
            heliosFinalDamage, 
            dominatorsFinalDamage,
            [heliosTotalInfantryDamage, heliosTotalArchersDamage, heliosTotalSpearmenDamage],
            [dominatorsTotalInfantryDamage, dominatorsTotalArchersDamage, dominatorsTotalSpearmenDamage],
            {
                infantry: heliosInfantryLevel,
                archers: heliosArchersLevel,
                spearmen: heliosSpearmenLevel
            },
            {
                infantry: dominatorsInfantryLevel,
                archers: dominatorsArchersLevel,
                spearmen: dominatorsSpearmenLevel
            },
            {
                infantry: heliosInfantryPercent,
                archers: heliosArchersPercent,
                spearmen: heliosSpearmenPercent
            },
            {
                infantry: dominatorsInfantryPercent,
                archers: dominatorsArchersPercent,
                spearmen: dominatorsSpearmenPercent
            },
            attacker
        );
    }
    
    // Get unit stats
    function getUnitStats(faction, unitType, level) {
        const levelIndex = level - 1;
        const statsKey = `${faction}${capitalizeFirstLetter(unitType)}`;
        
        if (unitStats[statsKey]) {
            return {
                attack: unitStats[statsKey].attack[levelIndex],
                defense: unitStats[statsKey].defense[levelIndex],
                health: unitStats[statsKey].health[levelIndex],
                lethality: unitStats[statsKey].lethality[levelIndex]
            };
        }
        
        return { attack: 0, defense: 0, health: 0, lethality: 0 };
    }
    
    // Apply battle skills
    function applyBattleSkills(faction, unitType, stats, level, enemyStats) {
        const modifiedStats = { ...stats };
        
        // Apply common skills
        if (battleSkills[unitType] && battleSkills[unitType].common) {
            battleSkills[unitType].common.forEach(skill => {
                if (skill.name === "سيد الشجعان" && unitType === 'infantry') {
                    // +10% damage against spearmen
                    modifiedStats.attack *= 1.1;
                } else if (skill.name === "دعامات فولاذية" && unitType === 'infantry') {
                    // +10% defense against spearmen
                    modifiedStats.defense *= 1.1;
                } else if (skill.name === "ضربة بعيدة المدى" && unitType === 'archers') {
                    // +10% damage against infantry
                    modifiedStats.attack *= 1.1;
                } else if (skill.name === "الاندفاع" && unitType === 'spearmen') {
                    // +10% damage against spearmen
                    modifiedStats.attack *= 1.1;
                }
            });
        }
        
        // Apply level-based skills
        if (unitType === 'infantry' && battleSkills[unitType] && battleSkills[unitType].levelBased) {
            for (let skillLevel in battleSkills[unitType].levelBased) {
                if (level >= parseInt(skillLevel)) {
                    const skill = battleSkills[unitType].levelBased[skillLevel];
                    
                    if (skill.name === "كريستال ناري") {
                        // Reduce damage by 25%
                        modifiedStats.defense *= 1.25;
                    } else if (skill.name === "كريستال أقوى") {
                        // Reduce damage by 35%
                        modifiedStats.defense *= 1.35;
                    } else if (skill.name === "جسم الضوء") {
                        // +4% defense, -10% damage
                        modifiedStats.defense *= 1.04;
                        modifiedStats.attack *= 0.9;
                    } else if (skill.name === "جسم الضوء II") {
                        // +6% defense, -15% damage
                        modifiedStats.defense *= 1.06;
                        modifiedStats.attack *= 0.85;
                    }
                }
            }
        }
        
        return modifiedStats;
    }
    
    // Calculate damage
    function calculateDamage(attackerStats, defenderStats) {
        return Math.max(0, (attackerStats.attack * (1 + attackerStats.lethality / 100)) - (defenderStats.defense * 0.5));
    }
    
    // Display battle results
    function displayBattleResults(isHeliosWinner, isDraw, heliosDamage, dominatorsDamage, heliosUnitDamage, dominatorsUnitDamage, heliosLevels, dominatorsLevels, heliosPercentages, dominatorsPercentages, attacker) {
        const battleResult = document.getElementById('battleResult');
        const battleWinner = document.getElementById('battleWinner');
        const battleDetails = document.getElementById('battleDetails');
        const battleAnalysis = document.getElementById('battleAnalysis');
        const resultGif = document.getElementById('resultGif');
        
        // Show battle result section
        battleResult.style.display = 'block';
        
        // Display winner
        if (isDraw) {
            battleWinner.textContent = "تعادل!";
            battleWinner.className = "battle-winner draw";
        } else if (isHeliosWinner) {
            battleWinner.textContent = "هيليوس انتصر!";
            battleWinner.className = "battle-winner helios";
            resultGif.src = "https://i.imgur.com/yLFc99G.gif";
        } else {
            battleWinner.textContent = "المهيمنين انتصروا!";
            battleWinner.className = "battle-winner dominant";
            resultGif.src = "https://i.imgur.com/rbmHcNu.gif";
        }
        
        // Show result GIF
        if (!isDraw) {
            resultGif.style.display = 'block';
        }
        
        // Display battle details
        const damageDifference = Math.abs(heliosDamage - dominatorsDamage);
        const damagePercentage = Math.round((damageDifference / Math.min(heliosDamage, dominatorsDamage)) * 100);
        
        let detailsHTML = '';
        detailsHTML += `<h4>تفاصيل المعركة:</h4>`;
        detailsHTML += `<p>المهاجم: ${attacker === 'helios' ? 'هيليوس' : 'المهيمنين'}</p>`;
        detailsHTML += `<p>إجمالي ضرر هيليوس: <strong>${Math.round(heliosDamage).toLocaleString()}</strong></p>`;
        detailsHTML += `<p>إجمالي ضرر المهيمنين: <strong>${Math.round(dominatorsDamage).toLocaleString()}</strong></p>`;
        
        if (!isDraw) {
            detailsHTML += `<p>فارق الضرر: <strong>${Math.round(damageDifference).toLocaleString()} (${damagePercentage}%)</strong></p>`;
        }
        
        battleDetails.innerHTML = detailsHTML;
        
        // Display battle analysis
        let analysisHTML = '';
        analysisHTML += `<h4>تحليل المعركة:</h4>`;
        
        if (isHeliosWinner) {
            analysisHTML += `<p>تفوقت قوات هيليوس بفضل `;
            
            if (heliosLevels.infantry >= 5) {
                analysisHTML += `مستوى المشاة العالي (${heliosLevels.infantry}) وتأثير مهارة "كريستال أقوى"، `;
            }
            
            if (heliosPercentages.archers > 30) {
                analysisHTML += `ونسبة الرماة العالية (${heliosPercentages.archers}%) والتي أثرت على الضرر الإجمالي، `;
            }
            
            if (attacker === 'helios') {
                analysisHTML += `وميزة المهاجم (+10% ضرر). `;
            }
            
            analysisHTML += `</p>`;
            
            // Suggest improvements for dominators
            analysisHTML += `<p>للمهيمنين: يمكن تحسين التشكيلة من خلال `;
            
            if (dominatorsLevels.infantry < 5) {
                analysisHTML += `رفع مستوى المشاة للاستفادة من مهارة "كريستال أقوى"، `;
            }
            
            if (dominatorsPercentages.archers < 30) {
                analysisHTML += `زيادة نسبة الرماة لزيادة الضرر الإجمالي، `;
            }
            
            analysisHTML += `</p>`;
        } else if (!isDraw) {
            analysisHTML += `<p>تفوقت قوات المهيمنين بفضل `;
            
            if (dominatorsLevels.infantry >= 5) {
                analysisHTML += `مستوى المشاة العالي (${dominatorsLevels.infantry}) وتأثير مهارة "كريستال أقوى"، `;
            }
            
            if (dominatorsPercentages.archers > 30) {
                analysisHTML += `ونسبة الرماة العالية (${dominatorsPercentages.archers}%) والتي أثرت على الضرر الإجمالي، `;
            }
            
            if (attacker === 'dominators') {
                analysisHTML += `وميزة المهاجم (+10% ضرر). `;
            }
            
            analysisHTML += `</p>`;
            
            // Suggest improvements for helios
            analysisHTML += `<p>لهيليوس: يمكن تحسين التشكيلة من خلال `;
            
            if (heliosLevels.infantry < 5) {
                analysisHTML += `رفع مستوى المشاة للاستفادة من مهارة "كريستال أقوى"، `;
            }
            
            if (heliosPercentages.archers < 30) {
                analysisHTML += `زيادة نسبة الرماة لزيادة الضرر الإجمالي، `;
            }
            
            analysisHTML += `</p>`;
        } else {
            analysisHTML += `<p>تعادلت القوتان بشكل مثير للدهشة! حاول تعديل التشكيلة أو المستويات للحصول على نتيجة حاسمة.</p>`;
        }
        
        battleAnalysis.innerHTML = analysisHTML;
        
        // Draw battle chart
        drawBattleChart(heliosUnitDamage, dominatorsUnitDamage);
    }
    
    // Draw battle chart
    function drawBattleChart(heliosData, dominatorsData) {
        const ctx = document.getElementById('battleChart');
        if (!ctx) return;
        
        // Destroy existing chart if it exists
        if (chartObjects.battleChart) {
            try {
                chartObjects.battleChart.destroy();
            } catch (e) {
                console.log('Error destroying battle chart:', e);
            }
        }
        
        // Format data for better display
        const formattedHeliosData = heliosData.map(value => Math.round(value));
        const formattedDominatorsData = dominatorsData.map(value => Math.round(value));
        
        // Create new chart
        chartObjects.battleChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['مشاة', 'رماة', 'رمح'],
                datasets: [
                    {
                        label: 'هيليوس',
                        data: formattedHeliosData,
                        backgroundColor: 'rgba(244, 67, 54, 0.5)',
                        borderColor: 'rgba(244, 67, 54, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'المهيمنين',
                        data: formattedDominatorsData,
                        backgroundColor: 'rgba(255, 193, 7, 0.5)',
                        borderColor: 'rgba(255, 193, 7, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'الضرر الإجمالي'
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'مقارنة الضرر بين الفصائل'
                    }
                }
            }
        });
    }
    
    // Start challenge
    function startChallenge() {
        // Implementation for challenge mode would go here
        alert('سيتم تنفيذ التحدي قريباً!');
    }
    
    // Helper function to capitalize first letter
    function capitalizeFirstLetter(string) {
        return string.charAt(0).toUpperCase() + string.slice(1);
    }
    
    // Google Analytics click tracking function
    function trackClick(buttonName) {
        if (typeof gtag !== 'undefined') {
            gtag('event', 'click', {
                'event_category': 'Social Media',
                'event_label': buttonName,
                'value': 1
            });
        }
    }

    // Modal functionality
    function hideModal() {
        const modal = document.getElementById('subscriptionModal');
        modal.classList.add('hidden');
    }

    // Show modal on page load
    window.addEventListener('load', function() {
        const modal = document.getElementById('subscriptionModal');
        modal.style.display = 'flex';
    });

    // Optional: Hide modal when clicking outside the content area
    document.getElementById('subscriptionModal').addEventListener('click', function(e) {
        if (e.target === this) {
            hideModal();
        }
    });

    // Protection against code copying and theft
    // Disable right-click context menu
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        return false;
    });

    // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U, Ctrl+Shift+C, Ctrl+S
    document.addEventListener('keydown', function(e) {
        // F12 key
        if (e.keyCode === 123) {
            e.preventDefault();
            return false;
        }
        // Ctrl+Shift+I (Developer tools)
        if (e.ctrlKey && e.shiftKey && e.keyCode === 73) {
            e.preventDefault();
            return false;
        }
        // Ctrl+Shift+J (Console)
        if (e.ctrlKey && e.shiftKey && e.keyCode === 74) {
            e.preventDefault();
            return false;
        }
        // Ctrl+U (View source)
        if (e.ctrlKey && e.keyCode === 85) {
            e.preventDefault();
            return false;
        }
        // Ctrl+Shift+C (Inspect element)
        if (e.ctrlKey && e.shiftKey && e.keyCode === 67) {
            e.preventDefault();
            return false;
        }
        // Ctrl+S (Save page)
        if (e.ctrlKey && e.keyCode === 83) {
            e.preventDefault();
            return false;
        }
        // Ctrl+A (Select all)
        if (e.ctrlKey && e.keyCode === 65) {
            e.preventDefault();
            return false;
        }
        // Ctrl+P (Print)
        if (e.ctrlKey && e.keyCode === 80) {
            e.preventDefault();
            return false;
        }
    });

    // Disable text selection with mouse
    document.onselectstart = function() {
        return false;
    };

    // Disable drag and drop
    document.ondragstart = function() {
        return false;
    };

    // Alert when developer tools are opened
    let devtools = {
        open: false,
        orientation: null
    };
    const threshold = 160;
    setInterval(function() {
        if (window.outerHeight - window.innerHeight > threshold || 
            window.outerWidth - window.innerWidth > threshold) {
            if (!devtools.open) {
                devtools.open = true;
                console.clear();
                console.log('%c⚠️ تحذير: محاولة الوصول لكود المصدر', 'color: red; font-size: 30px; font-weight: bold;');
                console.log('%c🔒 هذا المحتوى محمي بحقوق الطبع والنشر', 'color: red; font-size: 20px;');
                console.log('%c🚫 أي محاولة لنسخ أو تعديل الكود مخالفة قانونية', 'color: red; font-size: 16px;');
            }
        } else {
            devtools.open = false;
        }
    }, 500);

    // Clear console periodically
    setInterval(function() {
        console.clear();
    }, 1000);

    // Disable print screen
    document.addEventListener('keyup', function(e) {
        if (e.keyCode === 44) {
            document.body.style.display = 'none';
            setTimeout(function() {
                document.body.style.display = 'block';
            }, 100);
        }
    });

    // Protection message for copy attempts
    document.addEventListener('copy', function(e) {
        e.clipboardData.setData('text/plain', 'محتوى محمي - لا يمكن النسخ');
        e.preventDefault();
    });
</script>
</body>
</html>
